<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Baptiste CRINIERE-BOIZET" />


<title>Polygenic Risk Score (PRS)</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My new website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Project
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./GMRS.html">GMRS</a>
    </li>
    <li>
      <a href="./PRS.html">PRS</a>
    </li>
  </ul>
</li>
<li>
  <a href="./Contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/githubusername/mywebsite">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Polygenic Risk Score (PRS)</h1>
<h4 class="author">Baptiste CRINIERE-BOIZET</h4>
<h4 class="date">22/07/2021</h4>

</div>


<p>This code concerns the construction of polygenic risk scores as well as their evaluation. We built our models from two GWASs and their summary statistics, the first from the work of Kunkle and his team, the second from Jansen and his team. Then we tested our model in ADNI database. # Library</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(LDheatmap)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(rmarkdown)    </a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(epuRate)      </a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(vroom)        </a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(rrBLUP)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">library</span>(stats)</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">library</span>(matlib)</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">library</span>(pROC)</a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">library</span>(DescTools)</a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw">library</span>(lmtest)</a>
<a class="sourceLine" id="cb1-12" title="12"><span class="kw">library</span>(FSA)</a></code></pre></div>
<div id="data-management" class="section level1">
<h1>Data management</h1>
<p>Creation of the cojo files ## Jansen</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># Jansen</span></a>
<a class="sourceLine" id="cb2-2" title="2">Jansen &lt;-<span class="st"> </span><span class="kw">vroom</span>(<span class="st">&quot;/AD_sumstats_Jansenetal_2019sept.txt&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" title="3">Jansen &lt;-<span class="st"> </span>Jansen <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(EAF <span class="op">&gt;</span><span class="fl">0.01</span> <span class="op">&amp;</span><span class="st"> </span>EAF<span class="op">&lt;</span><span class="fl">0.99</span>)</a>
<a class="sourceLine" id="cb2-4" title="4">Jansen &lt;-<span class="st"> </span>Jansen <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(SNP, A1, A2, EAF, BETA, SE, Pp, Neff)</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw">write.table</span>(Jansen, <span class="st">&quot;Jansen.ma&quot;</span>, <span class="dt">col.names =</span> F, <span class="dt">row.names =</span> F, <span class="dt">quote=</span>F)</a></code></pre></div>
<div id="kunkle" class="section level2">
<h2>Kunkle</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># Kunkle</span></a>
<a class="sourceLine" id="cb3-2" title="2">Kunkle &lt;-<span class="st"> </span><span class="kw">vroom</span>(<span class="st">&quot;C:/Users/bapti/OneDrive/Documents/Travail/Stage/Code/Kunkle_p-value.ma&quot;</span>)</a>
<a class="sourceLine" id="cb3-3" title="3">Kunkle &lt;-<span class="st"> </span>Kunkle <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(MarkerName, Effect_allele, Non_Effect_allele, Beta, SE, Pvalue)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co"># Neff is missing for the Kunkle as well as the MAF. We get the MAF from the Jansen and we use Neff given in the article</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">write.table</span>(Kunkle, <span class="st">&quot;Kunkle.ma&quot;</span>, <span class="dt">col.names =</span> F, <span class="dt">row.names =</span> F, <span class="dt">quote=</span>F)</a></code></pre></div>
</div>
</div>
<div id="sblup" class="section level1">
<h1>SBLUP</h1>
<p>SBLUP weights are calculated independently for each chromosome. With the exception of chromosome 19 for which only the APOE zone will be used, because the BLUP normality assumption is no longer verified on this chromosome. ## Jansen</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">for</span> <span class="ex">nb</span> in <span class="dt">{1..18}</span><span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="ex">gcta64</span> --bfile chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span> --cojo-file Jansen.ma --cojo-sblup 1.33e6 --cojo-wind 1000 --thread-num 20 --out BLUP_Jansen_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">done</span> </a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">for</span> <span class="ex">nb</span> in <span class="dt">{20..22}</span><span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="ex">gcta64</span> --bfile chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span> --cojo-file Kunkle.ma --cojo-sblup 1.33e6 --cojo-wind 1000 --thread-num 20 --out BLUP_Jansen_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="kw">done</span> </a></code></pre></div>
<div id="kunkle-1" class="section level2">
<h2>Kunkle</h2>
</div>
<div id="jansen" class="section level2">
<h2>Jansen</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">for</span> <span class="ex">nb</span> in <span class="dt">{1..18}</span><span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="ex">gcta64</span> --bfile chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span> --cojo-file Kunkle.ma --cojo-sblup 1.33e6 --cojo-wind 1000 --thread-num 20 --out BLUP_Kunkle_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw">done</span> </a>
<a class="sourceLine" id="cb5-4" title="4"><span class="kw">for</span> <span class="ex">nb</span> in <span class="dt">{20..22}</span><span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="ex">gcta64</span> --bfile chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span> --cojo-file Kunle.ma --cojo-sblup 1.33e6 --cojo-wind 1000 --thread-num 20 --out BLUP_Kunkle_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="kw">done</span> </a></code></pre></div>
</div>
</div>
<div id="blup" class="section level1">
<h1>Blup</h1>
<div id="jansen-1" class="section level2">
<h2>Jansen</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">for</span> <span class="ex">nb</span> in <span class="dt">{1..18}</span><span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="ex">plink</span> --bfile ADNI_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span> --score BLUP_Jansen_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span>.snp.blp 1 2 3 --out SCORE_Jansen_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span> </a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">done</span> </a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw">for</span> <span class="ex">nb</span> in <span class="dt">{20..22}</span><span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="ex">plink</span> --bfile ADNI_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span> --score BLUP_Jansen_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span>.snp.blp 1 2 3 --out SCORE_Jansen_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span> </a>
<a class="sourceLine" id="cb6-6" title="6"><span class="kw">done</span> </a></code></pre></div>
</div>
<div id="kunkle-2" class="section level2">
<h2>Kunkle</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">for</span> <span class="ex">nb</span> in <span class="dt">{1..18}</span><span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="ex">plink</span> --bfile ADNI_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span> --score BLUP_Kunkle_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span>.snp.blp 1 2 3 --out SCORE_Kunkle_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span> </a>
<a class="sourceLine" id="cb7-3" title="3"><span class="kw">done</span> </a>
<a class="sourceLine" id="cb7-4" title="4"><span class="kw">for</span> <span class="ex">nb</span> in <span class="dt">{20..22}</span><span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="ex">plink</span> --bfile ADNI_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span> --score BLUP_Kunkle_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span>.snp.blp 1 2 3 --out SCORE_Kunkle_chr_<span class="st">&quot;</span><span class="va">${nb}</span><span class="st">&quot;</span> </a>
<a class="sourceLine" id="cb7-6" title="6"><span class="kw">done</span> </a></code></pre></div>
</div>
<div id="sum-scores" class="section level2">
<h2>Sum scores</h2>
<p>We sum the scores of the 22 chromosomes with the exception of 19, in order to obtain a unique Alzheimer’s risk score. ## APOE We summarize all the information contained in chromosome 19 by the region of APOE alone. ### Jansen #### Creation of the APOE cojo file</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">APOE &lt;-<span class="st"> </span>Jansen[data2<span class="op">$</span>SNP <span class="op">==</span><span class="st"> &quot;rs7412&quot;</span> <span class="op">|</span><span class="st"> </span>data2<span class="op">$</span>SNP <span class="op">==</span><span class="st"> &quot;rs429358&quot;</span>,]</a>
<a class="sourceLine" id="cb8-2" title="2">APOE &lt;-<span class="st"> </span>APOE <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(SNP, A1, BETA)</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">write.table</span>(APOE, <span class="st">&#39;APOE_Jansen.cojo&#39;</span>,<span class="dt">row.names =</span> F, <span class="dt">col.names =</span> F, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">quote =</span> F)</a></code></pre></div>
<div id="apoe-score" class="section level4">
<h4>APOE score</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" title="1"><span class="ex">plink</span> --bfile ADNI_chr19  --score APOE_Jansen.cojo 1 2 3  --out PRS_Jansen_APOE</a></code></pre></div>
</div>
<div id="kunkle-3" class="section level3">
<h3>Kunkle</h3>
<div id="creation-of-the-apoe-cojo-file" class="section level4">
<h4>Creation of the APOE cojo file</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">APOE &lt;-<span class="st"> </span>Kunkle[data2<span class="op">$</span>SNP <span class="op">==</span><span class="st"> &quot;rs7412&quot;</span> <span class="op">|</span><span class="st"> </span>data2<span class="op">$</span>SNP <span class="op">==</span><span class="st"> &quot;rs429358&quot;</span>,]</a>
<a class="sourceLine" id="cb10-2" title="2">APOE &lt;-<span class="st"> </span>APOE <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(SNP, Effect_allele, Beta)</a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw">write.table</span>(APOE, <span class="st">&#39;APOE_Kunkle.cojo&#39;</span>,<span class="dt">row.names =</span> F, <span class="dt">col.names =</span> F, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">quote =</span> F)</a></code></pre></div>
</div>
<div id="apoe-score-1" class="section level4">
<h4>APOE score</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb11-1" title="1"><span class="ex">plink</span> --bfile ADNI_chr19  --score APOE_Kunkle.cojo 1 2 3  --out PRS_Kunkle_APOE</a></code></pre></div>
</div>
</div>
</div>
</div>
<div id="results" class="section level1">
<h1>Results</h1>
<div id="data-bases" class="section level2">
<h2>Data bases</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># Scores files</span></a>
<a class="sourceLine" id="cb12-2" title="2">SCOREJ &lt;-<span class="st"> </span><span class="kw">vroom</span>(<span class="dt">file =</span> <span class="st">&quot;PRS_J_final.txt&quot;</span>)</a>
<a class="sourceLine" id="cb12-3" title="3">SCOREK &lt;-<span class="st"> </span><span class="kw">vroom</span>(<span class="dt">file =</span> <span class="st">&quot;PRS_K_final.txt&quot;</span>, <span class="dt">delim =</span> <span class="st">&#39; &#39;</span>)</a>
<a class="sourceLine" id="cb12-4" title="4"></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co"># APOE scores</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">## APOE Kunkle</span></a>
<a class="sourceLine" id="cb12-7" title="7">SCORE_Kunkle_APOE &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;PRS_Kunkle_APOE&quot;</span>, <span class="dt">header =</span> T)</a>
<a class="sourceLine" id="cb12-8" title="8">SCORE_Kunkle_APOE &lt;-<span class="st"> </span>SCORE_Kunkle_APOE <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(IID, SCORE)</a>
<a class="sourceLine" id="cb12-9" title="9">SCORE_Kunkle_APOE &lt;-<span class="st"> </span>SCORE_Kunkle_APOE <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">APOE =</span> SCORE)</a>
<a class="sourceLine" id="cb12-10" title="10">SCOREK &lt;-<span class="st"> </span><span class="kw">merge</span>(SCOREK, SCORE_Kunkle_APOE, <span class="dt">by =</span> <span class="st">&quot;IID&quot;</span>)</a>
<a class="sourceLine" id="cb12-11" title="11"><span class="co">## APOE Jansen</span></a>
<a class="sourceLine" id="cb12-12" title="12">SCORE_Jansen_APOE &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;PRS_Jansen_APOE&quot;</span>, <span class="dt">header =</span> T)</a>
<a class="sourceLine" id="cb12-13" title="13">SCORE_Jansen_APOE &lt;-<span class="st"> </span>SCORE_Jansen_APOE <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(IID, SCORE)</a>
<a class="sourceLine" id="cb12-14" title="14">SCORE_Jansen_APOE &lt;-<span class="st"> </span>SCORE_Jansen_APOE <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">APOE =</span> SCORE)</a>
<a class="sourceLine" id="cb12-15" title="15">SCOREJ &lt;-<span class="st"> </span><span class="kw">merge</span>(SCOREJ, SCORE_Jansen_APOE, <span class="dt">by =</span> <span class="st">&quot;IID&quot;</span>)</a>
<a class="sourceLine" id="cb12-16" title="16"></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="co"># ADNI</span></a>
<a class="sourceLine" id="cb12-18" title="18">ADNI1 &lt;-<span class="st"> </span><span class="kw">vroom</span>(<span class="dt">file =</span> <span class="st">&#39;ADNI1_phenotypes_all_2020Update_conversion.txt&#39;</span>)</a>
<a class="sourceLine" id="cb12-19" title="19">ADNI2 &lt;-<span class="st"> </span><span class="kw">vroom</span>(<span class="dt">file =</span> <span class="st">&#39;ADNI2_GO_phenotypes_all_2020Update_conversion.txt&#39;</span>)</a>
<a class="sourceLine" id="cb12-20" title="20">ADNI1 &lt;-<span class="st"> </span>ADNI1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(PTID, Alz_bl, AGE, PTGENDER, PTEDUCAT, SITE, AlzProg, CDRSB_bl, ADAS11_bl, ADAS13_bl,MMSE_bl, ABETA_bl, TAU_bl, PTAU_bl, AlzMCI_bl, conversion1year, conversion2year, conversion3year,conversion4year, conversion5year, conversion10year)</a>
<a class="sourceLine" id="cb12-21" title="21">ADNI2 &lt;-<span class="st"> </span>ADNI2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(PTID, Alz_bl, AGE, PTGENDER, PTEDUCAT, SITE, AlzProg, CDRSB_bl, ADAS11_bl, ADAS13_bl,MMSE_bl, ABETA_bl, TAU_bl, PTAU_bl, AlzMCI_bl, conversion1year, conversion2year, conversion3year,conversion4year, conversion5year, conversion10year)</a>
<a class="sourceLine" id="cb12-22" title="22">ADNI &lt;-<span class="st"> </span><span class="kw">rbind</span>(ADNI1, ADNI2)</a>
<a class="sourceLine" id="cb12-23" title="23"></a>
<a class="sourceLine" id="cb12-24" title="24"><span class="co"># Merge</span></a>
<a class="sourceLine" id="cb12-25" title="25">SCOREJ &lt;-<span class="st"> </span><span class="kw">merge</span>(ADNI, SCOREJ, <span class="dt">by.x =</span> <span class="st">&quot;PTID&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;IID&quot;</span>)</a>
<a class="sourceLine" id="cb12-26" title="26">SCOREK &lt;-<span class="st"> </span><span class="kw">merge</span>(ADNI, SCOREK, <span class="dt">by.x =</span> <span class="st">&quot;PTID&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;IID&quot;</span>)</a></code></pre></div>
</div>
<div id="analyses" class="section level2">
<h2>Analyses</h2>
<div id="jansen-score" class="section level3">
<h3>Jansen SCORE</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># We can change the variable of interest that we seek to explain, by conversion variables, cognitive test, etc.</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co"># Logistic regression</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co"># Null model</span></a>
<a class="sourceLine" id="cb13-4" title="4">a &lt;-<span class="st"> </span><span class="kw">glm</span>(Alz_bl <span class="op">~</span><span class="st"> </span>AGE <span class="op">+</span><span class="st"> </span>PTGENDER <span class="op">+</span><span class="st"> </span>SITE, <span class="dt">data =</span> SCOREJ, <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co"># Score of the genome except chromosome 19</span></a>
<a class="sourceLine" id="cb13-6" title="6">b &lt;-<span class="st"> </span><span class="kw">glm</span>(Alz_bl <span class="op">~</span><span class="st"> </span>AGE <span class="op">+</span><span class="st"> </span>PTGENDER <span class="op">+</span><span class="st"> </span>SITE <span class="op">+</span><span class="st"> </span>SCORE, <span class="dt">data =</span> SCOREJ, <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co"># Score of APOE</span></a>
<a class="sourceLine" id="cb13-8" title="8">c &lt;-<span class="st"> </span><span class="kw">glm</span>(Alz_bl <span class="op">~</span><span class="st"> </span>AGE <span class="op">+</span><span class="st"> </span>PTGENDER <span class="op">+</span><span class="st"> </span>SITE <span class="op">+</span><span class="st"> </span>SCORE_APOE, <span class="dt">data =</span> SCOREJ, <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co"># Score of the genome and apoe</span></a>
<a class="sourceLine" id="cb13-10" title="10">d &lt;-<span class="st"> </span><span class="kw">glm</span>(Alz_bl <span class="op">~</span><span class="st"> </span>AGE <span class="op">+</span><span class="st"> </span>PTGENDER <span class="op">+</span><span class="st"> </span>SITE <span class="op">+</span><span class="st"> </span>SCORE <span class="op">+</span><span class="st"> </span>SCORE_APOE, <span class="dt">data =</span> SCOREJ, <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb13-11" title="11"><span class="kw">summary</span>(a)</a>
<a class="sourceLine" id="cb13-12" title="12"><span class="kw">summary</span>(b)</a>
<a class="sourceLine" id="cb13-13" title="13"><span class="kw">summary</span>(c)</a>
<a class="sourceLine" id="cb13-14" title="14"><span class="kw">summary</span>(d)</a>
<a class="sourceLine" id="cb13-15" title="15"></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="co"># Calculation of the pseudo R squared</span></a>
<a class="sourceLine" id="cb13-17" title="17">a1 &lt;-<span class="st"> </span><span class="kw">PseudoR2</span>(a, <span class="dt">which =</span> <span class="st">&quot;all&quot;</span>)</a>
<a class="sourceLine" id="cb13-18" title="18">b1 &lt;-<span class="st"> </span><span class="kw">PseudoR2</span>(b, <span class="dt">which =</span> <span class="st">&quot;all&quot;</span>)</a>
<a class="sourceLine" id="cb13-19" title="19">c1 &lt;-<span class="st"> </span><span class="kw">PseudoR2</span>(c, <span class="dt">which =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb13-20" title="20">d1 &lt;-<span class="st"> </span><span class="kw">PseudoR2</span>(d, <span class="dt">which =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb13-21" title="21"></a>
<a class="sourceLine" id="cb13-22" title="22"><span class="co"># Variance explained by scores</span></a>
<a class="sourceLine" id="cb13-23" title="23">b1<span class="op">-</span>a1</a>
<a class="sourceLine" id="cb13-24" title="24">c1<span class="op">-</span>a1</a>
<a class="sourceLine" id="cb13-25" title="25">d1<span class="op">-</span>a1</a>
<a class="sourceLine" id="cb13-26" title="26"></a>
<a class="sourceLine" id="cb13-27" title="27"><span class="co"># Likelihood ratio test for nested models</span></a>
<a class="sourceLine" id="cb13-28" title="28">stat &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="kw">logLik</span>(b)<span class="op">-</span><span class="kw">logLik</span>(a))</a>
<a class="sourceLine" id="cb13-29" title="29"><span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(stat,<span class="dt">df=</span><span class="kw">length</span>(b<span class="op">$</span>coef)<span class="op">-</span><span class="kw">length</span>(a<span class="op">$</span>coef))</a>
<a class="sourceLine" id="cb13-30" title="30">stat &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="kw">logLik</span>(c)<span class="op">-</span><span class="kw">logLik</span>(a))</a>
<a class="sourceLine" id="cb13-31" title="31"><span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(stat,<span class="dt">df=</span><span class="kw">length</span>(b<span class="op">$</span>coef)<span class="op">-</span><span class="kw">length</span>(a<span class="op">$</span>coef))</a>
<a class="sourceLine" id="cb13-32" title="32">stat &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="kw">logLik</span>(d)<span class="op">-</span><span class="kw">logLik</span>(a))</a>
<a class="sourceLine" id="cb13-33" title="33"><span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(stat,<span class="dt">df=</span><span class="kw">length</span>(b<span class="op">$</span>coef)<span class="op">-</span><span class="kw">length</span>(a<span class="op">$</span>coef))</a></code></pre></div>
</div>
<div id="kunkle-score" class="section level3">
<h3>Kunkle SCORE</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># Logistic regression</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co"># Null model</span></a>
<a class="sourceLine" id="cb14-3" title="3">a &lt;-<span class="st"> </span><span class="kw">glm</span>(Alz_bl <span class="op">~</span><span class="st"> </span>AGE <span class="op">+</span><span class="st"> </span>PTGENDER <span class="op">+</span><span class="st"> </span>SITE, <span class="dt">data =</span> SCOREK, <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co"># Score of the genome except chromosome 19</span></a>
<a class="sourceLine" id="cb14-5" title="5">b &lt;-<span class="st"> </span><span class="kw">glm</span>(Alz_bl <span class="op">~</span><span class="st"> </span>AGE <span class="op">+</span><span class="st"> </span>PTGENDER <span class="op">+</span><span class="st"> </span>SITE <span class="op">+</span><span class="st"> </span>SCORE, <span class="dt">data =</span> SCOREK, <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb14-6" title="6"><span class="co"># Score of APOE</span></a>
<a class="sourceLine" id="cb14-7" title="7">c &lt;-<span class="st"> </span><span class="kw">glm</span>(Alz_bl <span class="op">~</span><span class="st"> </span>AGE <span class="op">+</span><span class="st"> </span>PTGENDER <span class="op">+</span><span class="st"> </span>SITE <span class="op">+</span><span class="st"> </span>SCORE_APOE, <span class="dt">data =</span> SCOREK, <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb14-8" title="8"><span class="co"># Score of the genome and apoe</span></a>
<a class="sourceLine" id="cb14-9" title="9">d &lt;-<span class="st"> </span><span class="kw">glm</span>(Alz_bl <span class="op">~</span><span class="st"> </span>AGE <span class="op">+</span><span class="st"> </span>PTGENDER <span class="op">+</span><span class="st"> </span>SITE <span class="op">+</span><span class="st"> </span>SCORE <span class="op">+</span><span class="st"> </span>SCORE_APOE, <span class="dt">data =</span> SCOREK, <span class="dt">family =</span> <span class="kw">binomial</span>())</a>
<a class="sourceLine" id="cb14-10" title="10"><span class="kw">summary</span>(a)</a>
<a class="sourceLine" id="cb14-11" title="11"><span class="kw">summary</span>(b)</a>
<a class="sourceLine" id="cb14-12" title="12"><span class="kw">summary</span>(c)</a>
<a class="sourceLine" id="cb14-13" title="13"><span class="kw">summary</span>(d)</a>
<a class="sourceLine" id="cb14-14" title="14"></a>
<a class="sourceLine" id="cb14-15" title="15"><span class="co"># Calculation of the pseudo R squared</span></a>
<a class="sourceLine" id="cb14-16" title="16">a1 &lt;-<span class="st"> </span><span class="kw">PseudoR2</span>(a, <span class="dt">which =</span> <span class="st">&quot;all&quot;</span>)</a>
<a class="sourceLine" id="cb14-17" title="17">b1 &lt;-<span class="st"> </span><span class="kw">PseudoR2</span>(b, <span class="dt">which =</span> <span class="st">&quot;all&quot;</span>)</a>
<a class="sourceLine" id="cb14-18" title="18">c1 &lt;-<span class="st"> </span><span class="kw">PseudoR2</span>(c, <span class="dt">which =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb14-19" title="19">d1 &lt;-<span class="st"> </span><span class="kw">PseudoR2</span>(d, <span class="dt">which =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb14-20" title="20"></a>
<a class="sourceLine" id="cb14-21" title="21"><span class="co"># Variance explained by scores</span></a>
<a class="sourceLine" id="cb14-22" title="22">b1<span class="op">-</span>a1</a>
<a class="sourceLine" id="cb14-23" title="23">c1<span class="op">-</span>a1</a>
<a class="sourceLine" id="cb14-24" title="24">d1<span class="op">-</span>a1</a>
<a class="sourceLine" id="cb14-25" title="25"></a>
<a class="sourceLine" id="cb14-26" title="26"><span class="co"># Likelihood ratio test for nested models</span></a>
<a class="sourceLine" id="cb14-27" title="27">stat &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="kw">logLik</span>(b)<span class="op">-</span><span class="kw">logLik</span>(a))</a>
<a class="sourceLine" id="cb14-28" title="28"><span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(stat,<span class="dt">df=</span><span class="kw">length</span>(b<span class="op">$</span>coef)<span class="op">-</span><span class="kw">length</span>(a<span class="op">$</span>coef))</a>
<a class="sourceLine" id="cb14-29" title="29">stat &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="kw">logLik</span>(c)<span class="op">-</span><span class="kw">logLik</span>(a))</a>
<a class="sourceLine" id="cb14-30" title="30"><span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(stat,<span class="dt">df=</span><span class="kw">length</span>(b<span class="op">$</span>coef)<span class="op">-</span><span class="kw">length</span>(a<span class="op">$</span>coef))</a>
<a class="sourceLine" id="cb14-31" title="31">stat &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="kw">logLik</span>(d)<span class="op">-</span><span class="kw">logLik</span>(a))</a>
<a class="sourceLine" id="cb14-32" title="32"><span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(stat,<span class="dt">df=</span><span class="kw">length</span>(b<span class="op">$</span>coef)<span class="op">-</span><span class="kw">length</span>(a<span class="op">$</span>coef))</a></code></pre></div>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
